# 微信聊天记录分析工具

一个用于采集、分析和导出微信聊天记录的工具集。

## 功能特点

- 自动采集微信聊天记录
- 支持文本、图片、视频等多媒体内容
- 提供丰富的数据分析功能
- 支持多种格式导出
- 可视化分析结果

## 安装说明

### 1. 环境要求
- Python 3.7+
- Windows 操作系统（因使用 uiautomation）
- 微信 PC 版本

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 数据采集
```bash
python main.py
```
- 运行后会自动监控微信消息
- 请保持微信处于登录状态
- 需要采集哪个聊天记录就切换到对应窗口
- 按 Ctrl+C 可停止采集

### 2. 数据分析
```bash
python analysis_tool.py
```
功能选项：
1. 分析聊天记录
   - 基础统计信息
   - 活跃用户排名
   - 消息类型分布
   - 热门关键词
   - 互动关系网络
2. 清空聊天记录
3. 查询聊天记录
4. 显示使用说明

### 3. 数据导出
```bash
python export_tool.py
```
- 支持导出格式：CSV/JSON
- 可按时间范围导出
- 可按聊天对象��出

## 目录结构
```
├── main.py              # 主程序（数据采集）
├── analysis_tool.py     # 数据分析工具
├── export_tool.py       # 数据导出工具
├── requirements.txt     # 依赖包列表
├── src/                 # 源代码目录
│   ├── wx_monitor.py    # 微信监控模块
│   ├── db_handler.py    # 数据库处理模块
│   └── data_analyzer.py # 数据分析模块
├── data/               # 数据存储目录
│   ├── wx_chat.db      # 数据库文件
│   └── media/          # 媒体文件目录
├── exports/            # 导出文件目录
├── logs/               # 日志目录
└── analysis_results/   # 分析结果目录
```

## 注意事项

1. 首次使用：
   - 确保已安装所有依赖
   - 需要先运行 main.py 采集数据
   - 检查中文字体是否正确安装

2. 数据安全：
   - 定期备份数据库文件
   - 清空数据前先导出备份
   - 注意保护隐私信息

3. 使用建议：
   - 建议定期清理媒体文件
   - 导出大量数据时可能需要较长时间
   - 分析大量数据时注意内存占用

## 常见问题

1. 无法采集消息？
   - 检查微信是否正常登录
   - 确认是否有正确的窗口焦点
   - 检查程序运行权限

2. 分析图表无法显示中文？
   - 检查是否安装了所需字体
   - Windows 需要微软雅黑等中文字体
   - Linux 需要文泉驿等中文字体

3. 导出失败？
   - 检查存储空间是否充足
   - 确认导出路径是否有写入权限
   - 检查文件是否被其他程序占用

## 更新日志

### v1.0.0
- 基础功能实现
- 支持数据采集和分析
- 添加导出功能
- 实现可视化分析

## 联系方式

如有问题或建议，请提交 Issue 或 Pull Request。

## 许可证

[MIT License](LICENSE)
